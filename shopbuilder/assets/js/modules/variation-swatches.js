(()=>{"use strict";function t(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),e.push.apply(e,n)}return e}function r(r){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?t(Object(a),!0).forEach(function(t){e(r,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(a,t))})}return r}function e(t,r,e){return(r=function(t){var r=function(t,r){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==i(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function n(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,a,i,o,s=[],c=!0,u=!1;try{if(i=(e=e.call(t)).next,0===r){if(Object(e)!==e)return;c=!1}else for(;!(c=(n=i.call(e)).done)&&(s.push(n.value),s.length!==r);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=e.return&&(o=e.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(t,r)||function(t,r){if(t){if("string"==typeof t)return a(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?a(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}!function(t){if("undefined"!=typeof rtsbVsParams){var e=function(){var t=(window.RTSB||{}).cache,r=(null==t?void 0:t.create("variationSwatches"))||null;return{name:"variationSwatches",version:"1.0.0",init:function(){return this.run(),r.set("initialized",!0),this},refresh:function(){this.run()},run:function(){a(r),h()},destroy:function(){r.clear()}}},a=function(r){t("form.variations_form").addClass("rtsb-single-cart"),t("div.variations_form").addClass("rtsb-showcase-cart"),t("body").on("click",".rtsb-term-more-btn",function(r){r.preventDefault(),t(r.currentTarget).parents(".rtsb-terms-wrapper").removeClass("has-more-variation"),t(r.currentTarget).remove()});for(var e=document.querySelectorAll(".variations_form:not(.rtsb_av_loaded):not(.rtsb_av_loading)"),n=0;n<e.length;n++){new IntersectionObserver(function(t,e){return o(t,e,r)},{root:null,rootMargin:"0px",threshold:0}).observe(e[n])}},o=function(r,e,n){r.forEach(function(r){if(r.isIntersecting){var a=r.target;if(a.classList.contains("rtsb_av_loading")||a.classList.contains("rtsb_av_loaded"))e.unobserve(a);else{var i=parseInt(a.getAttribute("data-product_id"),10);if(i){var o=t(a),c=null==n?void 0:n.get("product_".concat(i));if(c)return s(o,c),void e.unobserve(a);t.ajax({type:"POST",url:rtsbVsParams.ajax_url,data:{action:"rtsb_load_product_variation",__rtsb_wpnonce:rtsbVsParams.__rtsb_wpnonce,product_id:i},beforeSend:function(){a.classList.add("rtsb_av_loading")},success:function(t){t.success&&(null==n||n.set(i,t.data),s(o,t.data))},error:function(){console.error("Error Loading Data...")},complete:function(){o.removeClass("rtsb_av_loading")}}),e.unobserve(a)}else e.unobserve(a)}}})},s=function(t,r){t.addClass("rtsb_av_loaded"),t.data("product_variations",r),setTimeout(function(){t.on("wc_variation_form.rtsb_variation_form_initialized",function(t){c(t.currentTarget)}).wc_variation_form(),t.trigger("rtsb_variation_form_initialized",[t.get(0)])},100)},c=function(r){var e=t(r),n=e.data("product_variations"),a=e.find(".variations select"),i=!!n,o=e.hasClass("rtsb-showcase-cart"),s=t("body").hasClass("rtsb-is-mobile");u({variationForm:e,isMobile:s}),l({variationForm:e,productVariations:n,isAjax:i}),v({variationForm:e,attributeTerms:a,isShowcase:o})},u=function(r){var e=r.variationForm,n=r.isMobile;e.find(".rtsb-terms-wrapper").each(function(r,a){var i=t(a),o=i.parent().find("select.rtsb-wc-select");i.on("touchstart click",".rtsb-term",function(r){r.preventDefault(),r.stopPropagation();var a=t(r.currentTarget),i=a.hasClass("selected"),s=a.data("term");i&&(s=""),o.val(s).trigger("change").trigger("click").trigger("focusin"),n&&o.trigger("touchstart"),a.trigger("focus"),a.trigger(i?"rtsb-unselected-term":"rtsb-selected-term",[s,o,e])})}),setTimeout(function(){e.trigger("reload_product_variations"),e.trigger("rtsb_loaded",[e])},1)},l=function(t){var r=t.variationForm,e=t.productVariations,n=t.isAjax;r.on("rtsb_loaded",function(t){return b(t,n,e)}),r.on("woocommerce_update_variation_values",d),r.on("reset_data",function(t){return f(t,n)}),r.on("woocommerce_variation_has_changed",d),r.on("check_variations.rtsb-wc-variation-form",p)},d=function(r){t(r.currentTarget).find(".rtsb-terms-wrapper").each(function(r,e){var n=t(e),a=n.parent().find("select.rtsb-wc-select"),i=a.find("option:selected"),o=(a.find("option").eq(1),i.val()||""),s=[];a.find("option").each(function(r,e){var n=t(e).val();""!==n&&s.push(n)}),setTimeout(function(){n.find(".rtsb-term").each(function(r,e){var n=t(e),a=n.data("term");n.removeClass("selected disabled").addClass("disabled"),s.includes(a)?(n.removeClass("disabled").find("input.rtsb-radio-button-term:radio").prop("disabled",!1),a===o&&n.addClass("selected").find("input.rtsb-radio-button-term:radio").prop("checked",!0)):n.find("input.rtsb-radio-button-term:radio").prop("disabled",!0).prop("checked",!1)}),n.trigger("rtsb-terms-updated")},1)})},f=function(r,e){e&&t(r.currentTarget).find(".rtsb-terms-wrapper").each(function(r,e){t(e).find(".rtsb-term").removeClass("selected disabled").find("input.rtsb-radio-button-term:radio").prop("disabled",!1).prop("checked",!1)})},b=function(r,e,a){if(e){var o={};("object"===i(a)?a:JSON.parse(a)).forEach(function(t){Object.entries(t.attributes||{}).forEach(function(t){var r=n(t,2),e=r[0],a=r[1];o[e]||(o[e]=[]),a&&!o[e].includes(a)&&o[e].push(a)})}),t(r.target).find(".rtsb-terms-wrapper").each(function(r,e){var n=t(e),a=n.data("attribute_name");n.find(".rtsb-term").each(function(r,e){var n,i=t(e),s=i.attr("data-term");null!==(n=o[a])&&void 0!==n&&n.includes(s)||i.removeClass("selected").addClass("disabled").find("input.rtsb-radio-button-term:radio").prop("disabled",!0).prop("checked",!1)})})}},v=function(t){var e=t.variationForm,n=t.attributeTerms,a=t.isShowcase,i=window.location.toString(),o=e.closest(".rtsb-vs-product");a&&(i=o.find("a.woocommerce-LoopProduct-link").first().attr("href")||i);var s=new URL(i),c="".concat(s.origin).concat(s.pathname);e.on("check_variations.wc-variation-form",function(){var t=m(n),e=new URLSearchParams(r(r({},Object.fromEntries(s.searchParams)),t));!a&&e.size>0&&rtsbVsParams.hasPro&&rtsbVsParams.enable_variation_url&&window.history.pushState({},"","".concat(c,"?").concat(e.toString())),a&&e.size>0&&o.find(rtsbVsParams.url_link_selector).attr("href","".concat(c,"?").concat(e.toString()))})},m=function(r){var e={};return r.each(function(r,n){var a=t(n),i=a.data("attribute_name")||a.attr("name");a.val()&&(e[i]=a.val())}),e},p=function(r){rtsbVsParams.hasPro&&rtsbVsParams.attr_beside_label&&t(r.currentTarget).find(".rtsb-terms-wrapper").each(function(r,e){var n=t(e),a=n.parent().find("select.rtsb-wc-select"),i=a.find("option:selected").val(),o=n.parents("tr").find("th.label");if(o.find("span").remove(),i){var s=a.find("option:selected").text(),c=o.text().trim();o.html("".concat(c,"<span>:</span> <span>").concat(s,"</span>"))}})},h=function(){t(document).on("wc_variation_form.rtsb_variation_form_initialized",".variations_form.cart",function(t){c(t.currentTarget)})};if(window.RTSB&&window.RTSB._initialized){var _;null===(_=RTSB.modules.register("variationSwatches",e))||void 0===_||_.init()}else{var g=e();window.rtsbVariationSwatches=g.run,window.rtsbVariationSwatches()}}}(jQuery)})();