(()=>{"use strict";function t(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),e.push.apply(e,n)}return e}function r(r){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?t(Object(a),!0).forEach(function(t){e(r,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(a,t))})}return r}function e(t,r,e){return(r=function(t){var r=function(t,r){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==o(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function n(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,a,o,i,s=[],c=!0,u=!1;try{if(o=(e=e.call(t)).next,0===r){if(Object(e)!==e)return;c=!1}else for(;!(c=(n=o.call(e)).done)&&(s.push(n.value),s.length!==r);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=e.return&&(i=e.return(),Object(i)!==i))return}finally{if(u)throw a}}return s}}(t,r)||function(t,r){if(t){if("string"==typeof t)return a(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?a(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}!function(t){if("undefined"!=typeof rtsbVsParams){var e=function(){var t=(window.RTSB||{}).cache,r=(null==t?void 0:t.create("variationSwatches"))||null;return{name:"variationSwatches",version:"1.0.0",init:function(){return this.run(),r.set("initialized",!0),this},refresh:function(){this.run()},run:function(){a(r),_()},destroy:function(){r.clear()}}},a=function(r){t("form.variations_form").addClass("rtsb-single-cart"),t("div.variations_form").addClass("rtsb-showcase-cart"),t("body").on("click",".rtsb-term-more-btn",function(r){r.preventDefault(),t(r.currentTarget).parents(".rtsb-terms-wrapper").removeClass("has-more-variation"),t(r.currentTarget).remove()});for(var e=document.querySelectorAll(".variations_form:not(.rtsb_av_loaded):not(.rtsb_av_loading)"),n=0;n<e.length;n++){new IntersectionObserver(function(t,e){return i(t,e,r)},{root:null,rootMargin:"0px",threshold:0}).observe(e[n])}},i=function(r,e,n){r.forEach(function(r){if(r.isIntersecting){var a=r.target;if(a.classList.contains("rtsb_av_loading")||a.classList.contains("rtsb_av_loaded"))e.unobserve(a);else{var o=parseInt(a.getAttribute("data-product_id"),10);if(o){var i=t(a),c=null==n?void 0:n.get("product_".concat(o));if(c)return s(i,c),void e.unobserve(a);t.ajax({type:"POST",url:rtsbVsParams.ajax_url,data:{action:"rtsb_load_product_variation",__rtsb_wpnonce:rtsbVsParams.__rtsb_wpnonce,product_id:o},beforeSend:function(){a.classList.add("rtsb_av_loading")},success:function(t){t.success&&(null==n||n.set(o,t.data),s(i,t.data))},error:function(){console.error("Error Loading Data...")},complete:function(){i.removeClass("rtsb_av_loading")}}),e.unobserve(a)}else e.unobserve(a)}}})},s=function(t,r){t.addClass("rtsb_av_loaded"),t.data("product_variations",r),setTimeout(function(){t.on("wc_variation_form.rtsb_variation_form_initialized",function(t){c(t.currentTarget)}).wc_variation_form(),t.trigger("rtsb_variation_form_initialized",[t.get(0)])},100)},c=function(r){var e=t(r),n=e.data("product_variations"),a=e.find(".variations select"),o=!!n,i=e.hasClass("rtsb-showcase-cart"),s=t("body").hasClass("rtsb-is-mobile");u({variationForm:e,isMobile:s}),l({variationForm:e,productVariations:n,isAjax:o}),m({variationForm:e,attributeTerms:a,isShowcase:i})},u=function(r){var e=r.variationForm,n=r.isMobile;e.find("select.rtsb-wc-select").val()&&e.find(".reset_variations").addClass("show"),e.find(".rtsb-terms-wrapper").each(function(r,a){var o=t(a),i=o.parent().find("select.rtsb-wc-select");o.on("touchstart click",".rtsb-term",function(r){r.preventDefault(),r.stopPropagation();var a=t(r.currentTarget),o=a.hasClass("selected"),s=a.data("term");o&&(s=""),i.val(s).trigger("change").trigger("click").trigger("focusin"),n&&i.trigger("touchstart"),a.trigger("focus"),a.trigger(o?"rtsb-unselected-term":"rtsb-selected-term",[s,i,e])})}),setTimeout(function(){e.trigger("reload_product_variations"),e.trigger("rtsb_loaded",[e])},1)},l=function(r){var e=r.variationForm,n=r.productVariations,a=r.isAjax;e.on("rtsb_loaded",function(t){return v(t,a,n)}),e.on("woocommerce_update_variation_values",f),e.on("reset_data",function(t){return b(t,a)}),e.on("woocommerce_variation_has_changed",f),e.on("click.wc-variation-form",".reset_variations",{variationForm:e},function(r){r.preventDefault(),t(this).removeClass("show")}),e.on("change.wc-variation-form",".variations select",{variationForm:e},function(t){e.find(".reset_variations").addClass("show")})},d=function(r){0!==r.length&&setTimeout(function(){var e=r.find(".text");if(r.removeClass("success added "),0===e.length){var n=function(t){if(0!==t.length){return t.data("original-text")||Array.from(t.get(0).childNodes).filter(function(t){return t.nodeType===Node.TEXT_NODE}).map(function(t){return t.textContent.trim()}).filter(function(t){return t.length>0}).join(" ")}}(r);r.contents().filter(function(t,r){return r.nodeType===Node.TEXT_NODE}).remove();var a=rtsbPublicParams.singleCartBtnText,o=t("<span>",{class:"text","data-original-text":n,"data-success":a,text:n});r.append(o).append("<span></span>")}},600)},f=function(r){t(r.currentTarget).find(".rtsb-terms-wrapper").each(function(r,e){var n=t(e),a=n.parent().find("select.rtsb-wc-select"),o=a.find("option:selected"),i=(a.find("option").eq(1),o.val()||""),s=[];a.find("option").each(function(r,e){var n=String(t(e).val());""!==n&&s.push(n)}),setTimeout(function(){n.find(".rtsb-term").each(function(r,e){var n=t(e),a=String(n.data("term"));n.removeClass("selected disabled").addClass("disabled"),s.includes(a)?(n.removeClass("disabled").find("input.rtsb-radio-button-term:radio").prop("disabled",!1),a===i&&n.addClass("selected").find("input.rtsb-radio-button-term:radio").prop("checked",!0)):n.find("input.rtsb-radio-button-term:radio").prop("disabled",!0).prop("checked",!1)}),n.trigger("rtsb-terms-updated")},1)});var e=t(r.currentTarget).find(".single_add_to_cart_button");d(e)},b=function(r,e){e&&t(r.currentTarget).find(".rtsb-terms-wrapper").each(function(r,e){t(e).find(".rtsb-term").removeClass("selected disabled").find("input.rtsb-radio-button-term:radio").prop("disabled",!1).prop("checked",!1)})},v=function(r,e,a){if(e){var i={};("object"===o(a)?a:JSON.parse(a)).forEach(function(t){Object.entries(t.attributes||{}).forEach(function(t){var r=n(t,2),e=r[0],a=r[1];i[e]||(i[e]=[]),a&&!i[e].includes(a)&&i[e].push(a)})}),t(r.target).find(".rtsb-terms-wrapper").each(function(r,e){var n=t(e),a=n.data("attribute_name");n.find(".rtsb-term").each(function(r,e){var n,o=t(e),s=o.attr("data-term");null!==(n=i[a])&&void 0!==n&&n.includes(s)||o.removeClass("selected").addClass("disabled").find("input.rtsb-radio-button-term:radio").prop("disabled",!0).prop("checked",!1)})})}},m=function(t){var e=t.variationForm,n=t.attributeTerms,a=t.isShowcase,o=window.location.toString(),i=e.closest(".rtsb-vs-product");a&&(o=i.find("a.woocommerce-LoopProduct-link").first().attr("href")||o);var s=new URL(o),c="".concat(s.origin).concat(s.pathname);e.on("check_variations.wc-variation-form",function(){var t=p(n),e=new URLSearchParams(r(r({},Object.fromEntries(s.searchParams)),t));!a&&e.size>0&&rtsbVsParams.hasPro&&rtsbVsParams.enable_variation_url&&window.history.pushState({},"","".concat(c,"?").concat(e.toString())),a&&e.size>0&&i.find(rtsbVsParams.url_link_selector).attr("href","".concat(c,"?").concat(e.toString()))})},p=function(r){var e={};return r.each(function(r,n){var a=t(n),o=a.data("attribute_name")||a.attr("name");a.val()&&(e[o]=a.val())}),e},_=function(){t(document).on("wc_variation_form.rtsb_variation_form_initialized",".variations_form.cart",function(t){c(t.currentTarget)})},g=function(){if(window.RTSB&&window.RTSB._initialized){var t;null===(t=RTSB.modules.register("variationSwatches",e))||void 0===t||t.init()}else{var r=e();window.rtsbVariationSwatches=r.run,window.rtsbVariationSwatches()}};g(),t(document).on("berocket_ajax_filtering_end",function(){g(),console.log("Triggered: berocket_ajax_filtering_end ")}),t(document).on("rtsb_filter_ajax_load",function(){g(),console.log("Triggered: rtsb_filter_ajax_load ")})}}(jQuery)})();